import{_ as L,j as v,k as h,l as f,d as ie,m as ce,q as ue,F as de,G as fe,T as $e,H as Q,I as xe,v as Be,x as Ee,r as x,J as Fe,c as ve,K as le,L as se,o as Z,B as ze,M as Ie,N as U,O as oe,P as d,Q as T,t as A,R as G,s as re,S as K,U as Ae}from"./entry.92948795.js";const Ve={},qe={t:"1678102103095",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4727",width:"200",height:"200"},Te=f("path",{d:"M881 177l-104 104L830 334c18.8 18.8 18.8 49.2 0 67.8l-34.8 34.8c23.6 52.2 36.8 110.2 36.8 171.2 0 229.8-186.2 416-416 416S0 837.8 0 608 186.2 192 416 192c61 0 119 13.2 171.2 36.8L622 194c18.8-18.8 49.2-18.8 67.8 0l53 53 104-104 34.2 34zM1000 120h-48c-13.2 0-24 10.8-24 24s10.8 24 24 24h48c13.2 0 24-10.8 24-24s-10.8-24-24-24zM880 0c-13.2 0-24 10.8-24 24v48c0 13.2 10.8 24 24 24s24-10.8 24-24V24c0-13.2-10.8-24-24-24z m67.8 110l34-34c9.4-9.4 9.4-24.6 0-34-9.4-9.4-24.6-9.4-34 0l-34 34c-9.4 9.4-9.4 24.6 0 34 9.6 9.4 24.8 9.4 34 0z m-135.6 0c9.4 9.4 24.6 9.4 34 0 9.4-9.4 9.4-24.6 0-34l-34-34c-9.4-9.4-24.6-9.4-34 0-9.4 9.4-9.4 24.6 0 34l34 34z m135.6 68c-9.4-9.4-24.6-9.4-34 0-9.4 9.4-9.4 24.6 0 34l34 34c9.4 9.4 24.6 9.4 34 0 9.4-9.4 9.4-24.6 0-34l-34-34zM224 544c0-70.6 57.4-128 128-128 17.6 0 32-14.4 32-32s-14.4-32-32-32c-105.8 0-192 86.2-192 192 0 17.6 14.4 32 32 32s32-14.4 32-32z","p-id":"4728",fill:"currentColor"},null,-1),Le=[Te];function Pe(C,m){return v(),h("svg",qe,Le)}const Re=L(Ve,[["render",Pe]]),je={},Ne={t:"1678103260931",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5705",width:"200",height:"200"},Ue=f("path",{d:"M182.857143 146.285714q0 41.179429-36.571429 62.829714l0 723.456q0 7.460571-5.412571 12.873143t-12.873143 5.412571l-36.571429 0q-7.460571 0-12.873143-5.412571t-5.412571-12.873143l0-723.456q-36.571429-21.723429-36.571429-62.829714 0-30.281143 21.430857-51.712t51.712-21.430857 51.712 21.430857 21.430857 51.712zM1024 182.857143l0 436.004571q0 14.262857-7.168 22.016t-22.601143 15.725714q-122.88 66.267429-210.870857 66.267429-34.889143 0-70.582857-12.580571t-62.025143-27.428571-65.974857-27.428571-81.408-12.580571q-109.714286 0-265.142857 83.456-9.728 5.12-18.870857 5.12-14.848 0-25.746286-10.825143t-10.825143-25.746286l0-424.009143q0-18.285714 17.700571-31.451429 11.995429-7.972571 45.129143-24.576 134.875429-68.534857 240.566857-68.534857 61.147429 0 114.322286 16.603429t125.147429 50.322286q21.723429 10.825143 50.322286 10.825143 30.866286 0 67.145143-11.995429t62.829714-26.843429 50.322286-26.843429 31.158857-11.995429q14.848 0 25.746286 10.825143t10.825143 25.746286z",fill:"currentColor","p-id":"5706"},null,-1),Ge=[Ue];function Oe(C,m){return v(),h("svg",Ne,Ge)}const He=L(je,[["render",Oe]]),De={},Je={t:"1678254072982",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2122",width:"200",height:"200"},We=f("path",{d:"M512 1023.998046A511.999023 511.999023 0 0 1 312.610948 41.080156a511.999023 511.999023 0 0 1 398.778104 942.839689 508.993158 508.993158 0 0 1-199.389052 40.078201z m0-943.841643C273.534702 80.156403 80.15738 274.53568 80.15738 511.999023s193.377322 431.84262 431.84262 431.84262 431.84262-193.377322 431.84262-431.84262S749.463343 80.156403 512 80.156403z",fill:"currentColor","p-id":"2123"},null,-1),Ze=f("path",{d:"M320.626588 743.450636a40.078201 40.078201 0 0 1-28.054741-68.132942l381.744869-381.744869a40.383798 40.383798 0 0 1 57.111437 57.111437L349.683284 731.427176a40.078201 40.078201 0 0 1-29.056696 12.02346z",fill:"currentColor","p-id":"2124"},null,-1),Ke=f("path",{d:"M702.371457 743.450636a40.078201 40.078201 0 0 1-28.054741-12.02346L292.571847 349.682307a40.383798 40.383798 0 0 1 57.111437-57.111437l380.742914 382.746824a40.078201 40.078201 0 0 1-28.054741 68.132942z",fill:"currentColor","p-id":"2125"},null,-1),Qe=[We,Ze,Ke];function Xe(C,m){return v(),h("svg",Je,Qe)}const Ye=L(De,[["render",Xe]]),pe=C=>(Be("data-v-b97c1c45"),C=C(),Ee(),C),et=pe(()=>f("div",{class:"mw-ck-box-block"},null,-1)),tt={class:"ck-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},nt=pe(()=>f("path",{d:"M369.792 704.32L930.304 128 1024 223.616 369.984 896l-20.288-20.864-0.128 0.128L0 516.8 96.128 423.68l273.664 280.64z",fill:"currentColor"},null,-1)),at=[nt],lt={class:"ck-label"},st=ie({__name:"checkbox",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(C,{emit:m}){const n=C,u=()=>{n.disabled||m("update:modelValue",!n.modelValue)};return(_,B)=>(v(),h("div",{class:"ck-wrapper",onClick:u},[f("div",{class:Q(["ck-box-wrapper",{"mw-ck-box--checked":n.modelValue,"mw-ck-box--disabled":n.disabled}])},[et,ce($e,{name:"check"},{default:ue(()=>[de((v(),h("svg",tt,at,512)),[[fe,n.modelValue]])]),_:1})],2),f("span",lt,[xe(_.$slots,"default",{},void 0,!0)])]))}});const ot=L(st,[["__scopeId","data-v-b97c1c45"]]);function rt(C={}){const{fps:m=0,immediate:n=!1}=C,u=x(0),_=x(!1);let B=0,E=0,F=0,z=0;const S=Fe(m),O=ve(()=>S.value<=0?0:1e3/S.value),M=()=>{const y=performance.now();u.value=y-E,F=y},V=()=>{performance.now()-F>O.value&&M(),_.value&&(B=requestAnimationFrame(V))},k=()=>{_.value||(E=performance.now()-z,_.value=!0,B=requestAnimationFrame(V),M())},H=()=>{_.value&&(cancelAnimationFrame(B),z=performance.now()-E,_.value=!1,M())},P=()=>{const y=performance.now();E=y,F=y,z=0,u.value=0};return n&&k(),{time:le(u),isStarted:le(_),start:k,stop:H,reset:P}}const it=["onMousedown","onMouseup","onMouseenter"],ct={key:"showing",id:"lock-mask"},ut={key:0,id:"initializing-mask"},dt={id:"operations"},ft={class:"game-params"},vt={class:"cheat-hint"},pt={class:"btn-group"},g=100,gt=ie({__name:"minesweeper",setup(C){const m=se({avoidBadStart:!0,enableProp:!1});Z(()=>{const e=localStorage.getItem("config");if(e)try{const t=JSON.parse(e);if(!t)return;typeof t.avoidBadStart<"u"&&typeof t.avoidBadStart=="boolean"&&(m.avoidBadStart=t.avoidBadStart),typeof t.enableProp<"u"&&typeof t.enableProp=="boolean"&&(m.enableProp=t.enableProp)}catch{}}),ze(m,e=>{localStorage.setItem("config",JSON.stringify(Ae(e)))});const n=x([]),u=x(1),_=x(!1),B=e=>{const t=(Math.floor(e/36e5)%60).toString().padStart(2,"0"),a=(Math.floor(e/6e4)%60).toString().padStart(2,"0"),l=(Math.floor(e/1e3)%60).toString().padStart(2,"0"),c=(Math.floor(e)%1e3).toString().padStart(3,"0");return`${t}:${a}:${l}:${c}`},{time:E,reset:F,start:z,stop:S}=rt({fps:15,immediate:!1}),O=ve(()=>B(E.value)),M=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,V=(e,t,a)=>{const l=t-e,c=Math.random()**a;return Math.floor(c*l)+e},k=(e,t)=>{const a=[];return e-1>=0&&a.push({row:e-1,col:t,cell:n.value[e-1][t]}),t-1>=0&&a.push({row:e,col:t-1,cell:n.value[e][t-1]}),e+1<n.value.length&&a.push({row:e+1,col:t,cell:n.value[e+1][t]}),t+1<n.value[0].length&&a.push({row:e,col:t+1,cell:n.value[e][t+1]}),e-1>=0&&t-1>=0&&a.push({row:e-1,col:t-1,cell:n.value[e-1][t-1]}),e-1>=0&&t+1<n.value[0].length&&a.push({row:e-1,col:t+1,cell:n.value[e-1][t+1]}),e+1<n.value.length&&t-1>=0&&a.push({row:e+1,col:t-1,cell:n.value[e+1][t-1]}),e+1<n.value.length&&t+1<n.value[0].length&&a.push({row:e+1,col:t+1,cell:n.value[e+1][t+1]}),a},H=(e,t,a)=>{a===0&&(a=1),e*t===a&&e++,b.rows=e,b.cols=t,b.mineCount=a;const l=[];for(let r=0;r<e;r++){const i=[];for(let s=0;s<t;s++)i.push({id:r*e+s,mineCount:0,cellProp:0,revealed:!1,flagged:!1,showInfluence:!1,wrongFlag:!1,canFlag:!1,toReveal:!1});l.push(i)}const c=[];for(let r=0;r<e;r++)for(let i=0;i<t;i++)c.push({row:r,col:i});let o=0;for(;o<a;){const r=M(0,c.length-1),i=c[r];c.splice(r,1),l[i.row][i.col].mineCount=g,o++}n.value=l;for(let r=0;r<e;r++)for(let i=0;i<t;i++){if(l[r][i].mineCount===g)continue;const s=n.value[r][i],p=k(r,i).reduce((w,W)=>w+(W.cell.mineCount===g?1:0),0);s.mineCount=p}},P=(e,t,a=!1)=>{if(u.value!==2||e<0||e>=n.value.length||t<0||t>=n.value[0].length)return;const l=n.value[e][t];l.revealed||l.flagged||(l.mineCount===g?(u.value=4,S(),ne()):l.mineCount===0?X(e,t):l.revealed=!0,y())},y=()=>{u.value===2&&Me()&&(u.value=8,ne(!0),S())},I=x(0),ge=(e,t)=>{if(u.value!==2)return;const a=n.value[e][t];a.revealed||(a.flagged=!a.flagged,a.flagged?I.value++:I.value--)},X=(e,t)=>{if(e<0||e>=n.value.length||t<0||t>=n.value[0].length)return;const a=n.value[e][t];a.revealed||a.flagged||(a.revealed=!0,a.mineCount===0&&k(e,t).forEach(l=>X(l.row,l.col)))},me=(e,t)=>{if(n.value[e][t].mineCount===g){let l,c,o=0;for(;;){if(o>15){for(let s=0;s<n.value.length;s++)for(let p=0;p<n.value[0].length;p++)if(n.value[s][p].mineCount!==g){l=s,c=p;break}l=0,c=0}else{const s=M(0,n.value.length-1),p=M(0,n.value[0].length-1);if(n.value[s][p].mineCount!==g){l=s,c=p;break}}o++}let r=n.value[e][t];n.value[e][t]=n.value[l][c],n.value[l][c]=r;const i=new Set;i.add({row:e,col:t,cell:n.value[e][t]}),k(e,t).forEach(s=>i.add(s)),k(l,c).forEach(s=>i.add(s)),i.forEach(s=>{if(s.cell.mineCount===g)return;const p=k(s.row,s.col).reduce((w,W)=>w+(W.cell.mineCount===g?1:0),0);s.cell.mineCount=p})}};let $,R,q,Y,ee,D=!1;const j=x(""),he=(e,t,a)=>{switch(e.buttons){case 1:$=1;break;case 2:$=2;break;case 3:case 4:case 7:$=4,te(t,a);break}},_e=(e,t,a)=>{switch($){case 1:u.value===1&&(u.value=2,z(),m.avoidBadStart&&me(t,a)),P(t,a);break;case 2:u.value===1&&(u.value=2,z()),ge(t,a);break;case 4:we(t,a),J(),$=0;break}},N=e=>{if(!q)return;if(!e||!D){j.value="";return}const t=n.value[q.row][q.col];j.value=`${t.mineCount===g?"M":t.mineCount}`};Z(()=>{document.body.addEventListener("keydown",Y=e=>{e.repeat||e.key.toUpperCase()!=="Z"||(D=!0,N(!0))}),document.body.addEventListener("keyup",ee=e=>{e.key.toUpperCase()==="Z"&&(D=!1,N(!1))})}),Ie(()=>{document.body.removeEventListener("keydown",Y),document.body.removeEventListener("keyup",ee)});const Ce=(e,t,a)=>{q={row:t,col:a},N(!0),$===4&&(J(),te(t,a))},J=()=>{R&&R.forEach(e=>{e.cell.showInfluence=!1,e.cell.toReveal=!1,e.cell.canFlag=!1})},ke=()=>{N(!1)},be=()=>{$=0,q=null,J()},te=(e,t)=>{if(n.value[e][t].revealed){const a=k(e,t).filter(o=>!o.cell.revealed),l=a.filter(o=>!o.cell.flagged);a.reduce((o,r)=>o+(r.cell.flagged?1:0),0)>=n.value[e][t].mineCount?l.forEach(o=>{o.cell.toReveal=!0}):a.length===n.value[e][t].mineCount?l.forEach(o=>{o.cell.canFlag=!0}):l.forEach(o=>{o.cell.showInfluence=!0}),R=a}},we=(e,t)=>{const a=n.value[e][t];if(!a.revealed||a.mineCount<1||a.mineCount>8)return;const l=k(e,t);R.reduce((o,r)=>o+(r.cell.flagged?1:0),0)>=n.value[e][t].mineCount&&l.filter(o=>!o.cell.revealed).forEach(o=>P(o.row,o.col,!0))},ne=(e=!1)=>{for(let t=0;t<n.value.length;t++)for(let a=0;a<n.value[0].length;a++){const l=n.value[t][a];l.revealed||(l.mineCount===g&&e?l.flagged||(l.flagged=!0,I.value++):l.mineCount!==g&&l.flagged?(l.revealed=!0,l.wrongFlag=!0):l.revealed=!0)}},b=se({rows:0,cols:0,mineCount:0}),ae=()=>{const e=V(10,40,2),t=V(10,60,2),a=M(Math.floor(e*t*.08),Math.floor(e*t*.2));H(e,t,a)},Me=()=>{let e=0,t=0,a=0;for(let l=0;l<n.value.length;l++)for(let c=0;c<n.value[0].length;c++){const o=n.value[l][c];o.mineCount===g&&a++,!o.revealed&&!o.flagged?t++:o.flagged&&e++}return e+t===a},ye=()=>{u.value=1,_.value=!1,I.value=0,S(),F(),ae()},Se=()=>{u.value=1,_.value=!0,I.value=0,m.avoidBadStart=!1,S(),F();for(let e=0;e<n.value.length;e++)for(let t=0;t<n.value[0].length;t++)n.value[e][t]={id:n.value[e][t].id,mineCount:n.value[e][t].mineCount,cellProp:0,canFlag:!1,flagged:!1,revealed:!1,showInfluence:!1,toReveal:!1,wrongFlag:!1}};return Z(()=>{console.log("Welcome to the Konata version of Minesweeper! You can play by pressing either the left, right, or both mouse buttons. Hold 'z' if you wish to cheat. Enjoy the game!"),ae()}),(e,t)=>{const a=Re,l=He,c=Ye,o=ot;return v(),h("div",{id:"container",onContextmenu:t[2]||(t[2]=G(()=>{},["prevent"])),onMouseup:be},[f("div",{id:"board",class:Q({win:d(u)===8,lose:d(u)===4,initializing:d(n).length===0}),onMouseleave:ke},[(v(!0),h(U,null,oe(d(n),(r,i)=>(v(),h("div",{class:"row",key:i},[(v(!0),h(U,null,oe(r,(s,p)=>(v(),h("div",{class:Q(["cell",{unrevealed:!s.revealed,[`cell-${s.mineCount}`]:s.revealed,"show-influence":s.showInfluence,"wrong-flag":s.wrongFlag,"can-flag":s.canFlag,"to-reveal":s.toReveal}]),onMousedown:G(w=>he(w,i,p),["stop"]),onMouseup:G(w=>_e(w,i,p),["stop"]),onMouseenter:G(w=>Ce(w,i,p),["stop"]),key:s.id},[s.revealed?(v(),h(U,{key:0},[s.mineCount!==0&&s.mineCount!==g?(v(),h(U,{key:0},[re(A(s.mineCount),1)],64)):s.mineCount===g?(v(),K(a,{key:1,class:"mine"})):T("",!0)],64)):s.flagged?(v(),K(l,{key:1,class:"flag"})):T("",!0),s.wrongFlag?(v(),K(c,{key:2,class:"wrong-flag-icon"})):T("",!0)],42,it))),128))]))),128)),de(f("div",ct,null,512),[[fe,d(u)!==2&&d(u)!==1]]),d(n).length===0?(v(),h("div",ut,"加载中...")):T("",!0)],34),f("div",dt,[f("div",ft,[f("span",null,A(`时间: ${d(O)}`),1),f("span",null,A(`${d(b).rows} x ${d(b).cols} · ${d(b).mineCount} 雷`),1),f("span",null,A(`(${(d(b).mineCount/(d(b).rows*d(b).cols)*100).toFixed(2)}% 覆盖率)`),1),f("span",null,A(`${d(I)} 已标记`),1),f("span",vt,A(d(j)?`${d(j)}`:""),1)]),f("div",pt,[f("button",{type:"button",class:"btn",onClick:ye},"重新生成"),f("button",{type:"button",class:"btn",onClick:Se}," 重试本局 "),ce(o,{title:"保证第一次不是雷",disabled:d(u)===2||d(_),modelValue:d(m).avoidBadStart,"onUpdate:modelValue":t[0]||(t[0]=r=>d(m).avoidBadStart=r)},{default:ue(()=>[re("避免坏开局")]),_:1},8,["disabled","modelValue"]),T("",!0)])])],32)}}});const ht=L(gt,[["__scopeId","data-v-eb016d52"]]);export{ht as default};
